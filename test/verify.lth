assert := (require "chai").assert;
verify := (require "./../src/leathershield").verify;

describe "type verifier" by
  it "verifies a string" as
    assert.deepEqual(verify(`"type" of "String"), (`Type of `Simple of "string"))
  and_also it "verifies a integer" as
    assert.deepEqual(verify(`"type" of "Integer"), (`Type of `Simple of "int"))
  and_also it "verifies unit" as
    assert.deepEqual(verify(`"type" of "Unit"), (`Type of `Simple of "unit"))
  and_also it "verifies seq(unit, string)" as
    assert.deepEqual(verify(`"type" of "Sequence" & `left of `"type" of "Unit" & `right of `"type" of "String"), (`Type of `Simple of "string"))